{% extends "base/base.html" %}

{% block title %}{{ product.name }} - Solar Store{% endblock %}

{% block extra_css %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/products.css' %}">
{% endblock %}

{% block content %}
<a href="{% url 'product_list' %}" style="color: #667eea; text-decoration: none;">‚Üê Voltar para Produtos</a>

<div class="product-detail-container">
    <div class="product-image-container">
        {% if product.image_url %}
            <img src="{{ product.image_url }}" alt="{{ product.name }}" style="width: 100%; height: 400px; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'; this.nextElementSibling?.style.display='flex';">
            <div class="product-image-large" style="display: none;">‚òÄÔ∏è</div>
        {% elif product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width: 100%; height: 400px; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'; this.nextElementSibling?.style.display='flex';">
            <div class="product-image-large" style="display: none;">‚òÄÔ∏è</div>
        {% else %}
            <div class="product-image-large">‚òÄÔ∏è</div>
        {% endif %}
    </div>

    <div class="product-details">
        <h1>{{ product.name }}</h1>
        <div class="product-seller">
            <strong>Vendedor:</strong> {{ product.seller.company_name }}
        </div>
        <div class="product-rating">
            ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (0 avalia√ß√µes)
        </div>

        <div class="product-price-large">
            R$ {{ product.price|floatformat:2 }}
        </div>

        {% if product.quantity > 0 %}
            <div style="color: #28a745; margin-bottom: 1rem;">
                ‚úÖ {{ product.quantity }} em estoque
            </div>
        {% else %}
            <div style="color: #d9534f; margin-bottom: 1rem;">
                ‚ùå Produto fora de estoque
            </div>
        {% endif %}

        {% if product.description %}
            <div class="product-description-full">
                {{ product.description }}
            </div>
        {% endif %}

        <div class="product-specs">
            <h3>Informa√ß√µes</h3>
            <div class="spec-item">
                <span>SKU:</span>
                <span>{{ product.slug }}</span>
            </div>
            <div class="spec-item">
                <span>Categoria:</span>
                <span>Energia Solar</span>
            </div>
            <div class="spec-item">
                <span>Data de Adi√ß√£o:</span>
                <span>{{ product.created_at|date:"d/m/Y" }}</span>
            </div>
        </div>

        {% if product.quantity > 0 %}
            {% if not is_seller %}
                <form method="post" action="{% url 'add_to_cart' slug=product.slug %}" style="display: flex; flex-direction: column; gap: 1.5rem;">
                    {% csrf_token %}
                    <div class="quantity-selector">
                        <label for="quantity">Quantidade:</label>
                        <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ product.quantity }}" required>
                    </div>

                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">
                            üõí Adicionar ao Carrinho
                        </button>
                        <button type="button" class="btn btn-secondary">
                            ‚ô° Adicionar √† Lista
                        </button>
                    </div>
                    <input type="hidden" name="next" value="{{ request.path }}">
                </form>
            {% else %}
                <div style="background: #e3f2fd; padding: 1.5rem; border-radius: 8px; text-align: center; color: #1976d2;">
                    <p>üìä Voc√™ est√° visualizando este produto como <strong>Vendedor</strong>.</p>
                    <p style="margin-bottom: 0;">Clientes podem adicionar este produto ao carrinho.</p>
                </div>
            {% endif %}
        {% else %}
            <button class="btn btn-secondary btn-block" disabled>
                Produto Indispon√≠vel
            </button>
        {% endif %}
    </div>
</div>
{% endblock %}
